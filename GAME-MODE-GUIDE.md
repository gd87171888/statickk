# 🎮 游戏模式使用指南 | Game Mode Guide

## 简介

游戏模式是一个类似 **Synthesia** 和 **Piano Tiles** 的节奏游戏，让你在玩游戏的过程中学习钢琴！音符会从屏幕上方落下，你需要在它们到达判定线时按下正确的琴键。

## ✨ 主要特性

- 🎯 **精准判定系统** - Perfect / Good / Miss 三级判定
- 🔥 **连击系统** - 连续命中增加连击数，Miss会清零
- 📊 **实时统计** - 分数、连击、准确率实时显示
- 🏆 **成就系统** - 解锁多种成就徽章
- 💾 **本地排行榜** - 自动保存每首歌的最高分
- 🎚️ **三种难度** - 简单、普通、困难，适合不同水平
- 🎹 **虚拟键盘** - 支持鼠标/触摸点击虚拟钢琴键盘
- ⌨️ **键盘控制** - 完整的键盘映射支持

## 🎮 游戏规则

### 判定系统

游戏根据你按键的时机给出不同的判定：

| 判定等级 | 时间窗口 | 得分 | 效果 |
|---------|---------|------|------|
| **Perfect** | ±50ms (简单: ±80ms, 困难: ±40ms) | +100分 | 🌟 金色显示，连击+1 |
| **Good** | ±120ms (简单: ±150ms, 困难: ±100ms) | +50分 | 💚 绿色显示，连击+1 |
| **Miss** | 超出判定窗口或未按键 | 0分 | ❌ 红色显示，连击清零 |

### 难度说明

#### 🟢 简单模式
- 下落速度：150 像素/秒
- 判定窗口：更宽松
- 音符数量：前50个音符
- 适合：初学者，第一次尝试

#### 🟡 普通模式
- 下落速度：200 像素/秒
- 判定窗口：标准
- 音符数量：前100个音符
- 适合：有一定基础的玩家

#### 🔴 困难模式
- 下落速度：250 像素/秒
- 判定窗口：严格
- 音符数量：完整曲目
- 适合：高手玩家，追求完美

## ⌨️ 键盘映射

### 白键（主音符）
```
键盘按键：A  S  D  F  G  H  J  K  L
对应音符：C4 D4 E4 F4 G4 A4 B4 C5 D5
唱名：   Do Re Mi Fa Sol La Si Do Re
```

### 黑键（升降音）
```
键盘按键：W  E     T  Y  U     O  P
对应音符：C# D#    F# G# A#    C# D#
```

### 游戏控制
- **暂停/继续**：点击右上角"暂停"按钮
- **退出游戏**：点击右上角"退出"按钮

## 🎯 游戏流程

### 1. 开始游戏
1. 打开 `game-mode.html` 页面
2. 从下拉菜单选择一首歌曲
3. 选择难度（简单/普通/困难）
4. 点击"开始游戏"按钮
5. 等待 3-2-1 倒计时

### 2. 游戏进行中
1. 音符从顶部落下
2. 观察音符的颜色和位置：
   - 🔴 粉色音符 = 白键
   - 🔵 蓝色音符 = 黑键
3. 在音符到达底部金色判定线时按键
4. 注意看判定反馈（Perfect/Good/Miss）
5. 保持连击获得更高分数

### 3. 游戏结束
- 所有音符判定完成后自动结束
- 查看详细统计数据
- 获得成就徽章
- 选择：再玩一次 / 换首歌 / 返回主页

## 🏆 成就系统

游戏结束后，根据你的表现可以解锁以下成就：

| 成就名称 | 解锁条件 | 图标 |
|---------|---------|-----|
| 完美演奏 | 准确率 ≥ 95% | 🏆 |
| 连击大师 | 最大连击 ≥ 50 | 🔥 |
| 精准之神 | Perfect 数量 ≥ 总音符的80% | ⭐ |
| 高分达人 | 总分 ≥ 5000 | 💎 |

## 📊 统计数据

游戏结束时会显示以下统计：

- **最终分数** - 累计得分
- **最大连击** - 游戏中达到的最高连击数
- **准确率** - (Perfect + Good) / 总音符数
- **Perfect数量** - 完美判定的次数
- **Good数量** - 良好判定的次数
- **Miss数量** - 失误的次数

## 💾 本地记录

游戏会自动保存每首歌曲在每个难度下的最高分到浏览器本地存储（localStorage）。

格式：`highscore_{歌曲名}_{难度}`

例如：
- `highscore_简单爱_normal`
- `highscore_canon_hard`

## 📱 移动端支持

游戏模式完全支持移动设备：

- ✅ 响应式布局自动适配屏幕
- ✅ 支持触摸点击虚拟键盘
- ✅ 优化的触摸反馈
- ✅ 横屏模式支持
- ✅ 流畅的动画性能

### 移动端操作提示
- 使用底部的虚拟钢琴键盘
- 直接点击/触摸对应的琴键
- 建议使用横屏模式获得更好体验

## 🎵 支持的歌曲

目前支持的歌曲列表：

**流行歌曲**
- 简单爱 - 周杰伦
- 告白气球 - 周杰伦
- 七里香 - 周杰伦
- 成都 - 赵雷
- 纸短情长 - 烟把儿

**经典名曲**
- 千与千寻 - 久石让
- One Summer's Day
- Canon in D - 卡农

## 💡 游戏技巧

### 对于初学者
1. **先选简单模式** - 熟悉游戏机制和按键位置
2. **专注判定线** - 眼睛盯着底部的金色判定线
3. **提前准备** - 音符到达前就把手指移到正确位置
4. **放松心态** - 不要因为Miss而紧张

### 对于进阶玩家
1. **追求Perfect** - 练习精准的时机把握
2. **保持连击** - 稳定性比速度更重要
3. **记忆曲谱** - 多玩几次熟悉音符序列
4. **挑战困难模式** - 提升反应速度和准确度

### 对于高手玩家
1. **完美通关** - 争取全Perfect
2. **速度挑战** - 在困难模式下保持高连击
3. **竞争排行** - 刷新个人最高分
4. **成就收集** - 解锁所有成就徽章

## 🔧 技术细节

### 渲染机制
- 使用 HTML5 Canvas 进行高性能渲染
- 基于 requestAnimationFrame 的游戏循环
- 动态计算音符位置确保时间同步

### 音频引擎
- 使用 Tone.js 作为音频引擎
- 加载真实钢琴采样音频
- 低延迟音频播放

### 时间同步
- 使用 `Date.now()` 作为时间基准
- 音符位置根据实际时间动态计算
- 确保视觉和音频完美同步

## ❓ 常见问题

### Q: 为什么有时候按对了也显示Miss？
A: 可能是时机稍微偏早或偏晚。注意音符要到达金色判定线时才按键，不要提前太多。

### Q: 如何提高准确率？
A: 
1. 练习时专注于判定线的位置
2. 多玩几次熟悉歌曲的节奏
3. 从简单模式开始练习
4. 保持放松，不要紧张

### Q: 可以使用MIDI键盘吗？
A: 当前版本暂不支持MIDI键盘输入，但你可以使用电脑键盘或鼠标/触摸虚拟键盘。

### Q: 成绩会保存吗？
A: 每首歌在每个难度的最高分会自动保存到浏览器本地存储，下次打开游戏仍然可以看到。

### Q: 可以添加自己的歌曲吗？
A: 需要将歌曲转换为项目支持的JSON格式，并放到 `static/xmlscore/` 目录下，然后在代码中添加歌曲选项。

## 🎊 祝你游戏愉快！

记住：**游戏的目的不只是高分，更重要的是在快乐中学习钢琴！**

玩得开心，不断进步！🎹✨
