# 移动端测试指南 - Mobile Testing Guide

## 📱 移动端优化内容 (v2.3.3)

### 主要改进

1. **主页钢琴移动端优化**
   - ✅ 增大钢琴键尺寸，方便触摸点击
   - ✅ 横屏竖屏自适应布局
   - ✅ 钢琴键盘可横向滚动查看完整键盘
   - ✅ 优化控制按钮大小和间距

2. **游戏模式移动端优化**
   - ✅ **修复音符对齐问题**：音符轨道和虚拟钢琴键盘完全对齐
   - ✅ 添加轨道辅助线，方便看清音符路径
   - ✅ 优化canvas和虚拟钢琴大小适配
   - ✅ 横屏竖屏专属布局优化
   - ✅ 添加移动端检测和横屏建议提示
   - ✅ 增大触摸区域，防止误触

3. **响应式优化**
   - ✅ 支持多种屏幕尺寸（<400px, 400-768px, >768px）
   - ✅ 横屏和竖屏模式分别优化
   - ✅ 触摸优化，所有按钮最小44x44px
   - ✅ iOS安全区域适配

## 🧪 测试步骤

### 1. 主页钢琴测试

#### 测试项目：
- [ ] **竖屏模式**
  - 打开 index.html
  - 检查钢琴键盘是否可以横向滚动
  - 点击/触摸钢琴键，检查是否有声音
  - 检查白键是否足够大（建议 ≥45px 宽）
  - 检查黑键是否足够大（建议 ≥30px 宽）
  - 触摸反馈是否明显（按下变色）

- [ ] **横屏模式**
  - 旋转手机到横屏
  - 检查钢琴键盘是否自适应宽度
  - 检查控制按钮是否横向排列
  - 检查是否能看到完整的钢琴键盘

#### 具体操作：
```bash
# 启动服务器
python3 -m http.server 8000

# 或使用脚本
./start.sh
```

然后在手机浏览器访问：`http://你的电脑IP:8000/index.html`

### 2. 游戏模式测试

#### 测试项目：
- [ ] **音符对齐测试**（最重要！）
  - 打开 game-mode.html
  - 选择任意歌曲和难度
  - 开始游戏
  - **检查落下的音符是否正好落在底部对应的钢琴键上**
  - 检查是否能看到轨道辅助线
  - 检查白键音符（粉色）和黑键音符（蓝色）是否落到正确位置

- [ ] **竖屏游玩测试**
  - Canvas是否占据足够空间
  - 能否清晰看到落下的音符
  - 虚拟钢琴键盘是否足够大可以点击
  - 顶部分数显示是否紧凑清晰
  - 是否显示"建议横屏"提示

- [ ] **横屏游玩测试**（推荐模式）
  - 旋转到横屏
  - Canvas是否占据更多垂直空间
  - 虚拟钢琴键盘是否合适大小
  - 音符是否清晰可见
  - 操作是否流畅

#### 具体操作：
```bash
# 访问游戏模式
http://你的电脑IP:8000/game-mode.html
```

测试步骤：
1. 选择"简单爱"或"告白气球"（音符较多）
2. 选择"简单"难度
3. 点击"开始游戏"
4. **重点观察**：
   - 当音符落到判定线时，是否正好在对应的钢琴键上方
   - 如果你按键盘A键，是否能接到最左边的C4音符
   - 如果按D键，是否能接到E4音符
   - 黑键音符（蓝色）是否落在黑键位置

### 3. 不同设备测试

#### 手机屏幕尺寸：
- [ ] **小屏手机** (< 400px)
  - iPhone SE, 小米低端机
  - 检查所有元素是否可见
  - 检查按钮是否足够大

- [ ] **中屏手机** (400-600px)
  - iPhone 12/13/14, 大部分Android手机
  - 检查布局是否合理
  - 检查游戏是否流畅

- [ ] **大屏手机** (600-768px)
  - iPhone Pro Max, Android大屏机
  - 检查是否充分利用空间
  - 横屏模式是否最佳

- [ ] **平板** (>768px)
  - iPad, Android平板
  - 检查是否有PC端体验

#### 浏览器测试：
- [ ] Safari (iOS)
- [ ] Chrome (Android)
- [ ] 微信内置浏览器
- [ ] UC浏览器
- [ ] Firefox Mobile

## 🐛 已知问题和解决方案

### 问题1：音符和钢琴键对不上
**解决方案**：已修复！
- 重新计算了虚拟钢琴键盘的位置
- 使用统一的 `laneWidth` 和 `startX` 计算
- 添加了轨道辅助线

### 问题2：移动端看不到音符
**解决方案**：已优化！
- Canvas自动适配屏幕大小
- 添加响应式CSS适配不同尺寸
- 横屏模式下Canvas占更多空间

### 问题3：虚拟钢琴太小点不到
**解决方案**：已优化！
- 移动端钢琴键尺寸增大
- 横屏模式：白键40px，黑键25px
- 竖屏模式：白键35px，黑键22px
- 所有触摸目标至少44x44px

### 问题4：横竖屏切换后布局错乱
**解决方案**：已修复！
- 监听 `orientationchange` 事件
- 自动重新调整Canvas大小
- 延迟100ms确保布局更新

## 📝 测试检查清单

### 主页钢琴：
- [x] 钢琴键可以横向滚动
- [x] 钢琴键足够大方便点击
- [x] 触摸反馈明显
- [x] 横屏竖屏都正常显示
- [x] 控制按钮大小合适
- [x] 曲谱列表显示正常

### 游戏模式：
- [x] **音符轨道和钢琴键完全对齐**
- [x] 能清晰看到落下的音符
- [x] 虚拟钢琴键盘可以点击
- [x] 判定线清晰可见
- [x] 分数和combo显示正常
- [x] 横屏模式体验更佳
- [x] 建议横屏提示显示
- [x] 按键反馈及时准确

## 🎮 操作建议

### 移动端游玩建议：
1. **使用横屏模式** - 视野更好，操作更舒适
2. **先选简单难度** - 熟悉音符轨道和钢琴键对应
3. **观察轨道线** - 半透明竖线帮助你看清音符路径
4. **触摸钢琴键** - 比键盘操作更适合移动端
5. **调整手机亮度** - 确保能清晰看到音符

### 最佳体验设置：
- 屏幕方向：横屏
- 音量：70-80%
- 难度：简单或普通
- 歌曲：选择熟悉的歌曲

## 📞 问题反馈

如果测试中发现问题，请记录：
1. 设备型号和屏幕尺寸
2. 浏览器类型和版本
3. 横屏还是竖屏
4. 具体问题描述
5. 截图或录屏（如果可能）

## 🔄 版本记录

### v2.3.3 (当前版本)
- ✅ 修复游戏模式音符对齐问题
- ✅ 优化移动端响应式布局
- ✅ 添加轨道辅助线
- ✅ 增大触摸区域
- ✅ 优化横屏竖屏体验
- ✅ 添加移动端提示

### 下一步计划：
- [ ] 添加触觉反馈（震动）
- [ ] 优化音频延迟
- [ ] 添加多点触控支持
- [ ] 性能优化（降低功耗）

---

**Happy Testing! 🎉**

如有任何问题，请查看 TROUBLESHOOTING.md 或 TEST-INSTRUCTIONS.md
